<?xml version="1.0" encoding="UTF-8"?>
<layout>
    <jeroenvermeulen_blockcache_product_list>
        <reference name="category.products">
            <action method="setMessagesBlock" ifconfig="jeroenvermeulen_blockcache/category_page/enable_cache">
                <block helper="jeroenvermeulen_blockcache/data/getMessagesBlock"/>
            </action>
            <action method="unsetChild" ifconfig="jeroenvermeulen_blockcache/category_page/enable_cache">
                <alias>messages</alias>
            </action>
        </reference>
        <reference name="content">
            <action method="insert" ifconfig="jeroenvermeulen_blockcache/category_page/enable_cache">
                <blockName>messages</blockName>
                <siblingName>category.products</siblingName>
                <after>0</after>
            </action>
        </reference>
    </jeroenvermeulen_blockcache_product_list>

    <catalog_category_default>
        <update handle="jeroenvermeulen_blockcache_product_list"/>
    </catalog_category_default>

    <catalog_category_layered>
        <update handle="jeroenvermeulen_blockcache_product_list"/>
    </catalog_category_layered>

    <catalog_product_view>
        <reference name="product.info">
            <action method="unsetChild" ifconfig="jeroenvermeulen_blockcache/product_detail/enable_cache">
                <alias>messages</alias>
            </action>
        </reference>
        <reference name="content">
            <action method="insert" ifconfig="jeroenvermeulen_blockcache/product_detail/enable_cache">
                <blockName>messages</blockName>
                <siblingName>product.info</siblingName>
                <after>0</after>
            </action>
        </reference>
    </catalog_product_view>
</layout>